147a148,149
> var gEnv                  = null;
> var gConv                 = null;
1490,1491c1492,1496
<         var entryName = entries.getNext();
<         var target = installLocation.getItemFile(extensionID, entryName);
---
>         //var entryName = entries.getNext();
>         //var target = installLocation.getItemFile(extensionID, entryName);
>         // if utf8 filename or chinese filename by racklin
>         var entryName = gConv.ConvertFromUnicode(entries.getNext()); 
>         var target = installLocation.getItemFile(extensionID, gConv.ConvertToUnicode(entryName));
2329a2335,2341
>   gEnv = Components.classes["@mozilla.org/process/environment;1"]
>                    .getService(Components.interfaces.nsIEnvironment);
> 
>   gConv = Components.classes["@mozilla.org/intl/scriptableunicodeconverter"]
>                    .getService(Components.interfaces.nsIScriptableUnicodeConverter);
>   gConv.charset = "UTF-8";
> 
6262a6275,6278
>   aURI = aURI.replace(/%DALLAS%/g, gEnv.get("dallas"));
>   aURI = aURI.replace(/%MAC_ADDRESS%/g, gEnv.get("mac_address"));
>   aURI = aURI.replace(/%VENDOR_NAME%/g, gEnv.get("vendor_name"));
>   aURI = aURI.replace(/%SYSTEM_NAME%/g, gEnv.get("system_name"));
